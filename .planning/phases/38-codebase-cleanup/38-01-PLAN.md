---
phase: 38-codebase-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - variantcentrifuge/stage_info.py
  - variantcentrifuge/cli.py
  - variantcentrifuge/inheritance/prioritizer.py
  - variantcentrifuge/inheritance/analyzer.py
  - variantcentrifuge/stages/analysis_stages.py
  - tests/unit/test_backend_defaults.py
  - tests/test_inheritance/test_prioritizer.py
  - tests/test_inheritance/test_enhanced_prioritizer.py
  - tests/test_inheritance/test_analyzer.py
  - tests/test_inheritance/test_inheritance_integration.py
  - tests/test_inheritance/test_performance_optimizations.py
  - tests/integration/test_pipeline_with_mocked_tools.py
autonomous: true

must_haves:
  truths:
    - "stage_info.py does not exist and nothing imports it"
    - "--coast-backend accepts only 'auto' and 'python', not 'r'"
    - "Dead functions in prioritizer.py and analyzer.py are gone with no broken call sites"
    - "Redundant --gzip-intermediates flag is removed"
    - "Dead integration test methods are removed"
    - "All tests pass after removals"
  artifacts:
    - path: "variantcentrifuge/stage_info.py"
      provides: "DELETED — must not exist"
    - path: "variantcentrifuge/cli.py"
      provides: "coast-backend choices=['auto','python'], no --gzip-intermediates store_true"
      contains: "choices=[\"auto\", \"python\"]"
    - path: "variantcentrifuge/inheritance/prioritizer.py"
      provides: "Only prioritize_patterns, calculate_confidence, get_pattern_description"
    - path: "variantcentrifuge/inheritance/analyzer.py"
      provides: "No get_inheritance_summary, filter_by_inheritance_pattern, export_inheritance_report; create_inheritance_details renamed to _create_inheritance_details"
  key_links:
    - from: "variantcentrifuge/inheritance/analyzer.py"
      to: "_create_inheritance_details"
      via: "internal call from _finalize_inheritance_patterns"
      pattern: "_create_inheritance_details"
---

<objective>
Remove all dead code identified in requirements DEAD-01 through DEAD-05 and CLEAN-04: delete stage_info.py, remove --coast-backend r choice, remove dead functions from prioritizer.py and analyzer.py, remove redundant --gzip-intermediates flag, and remove dead integration test methods. Also remove all corresponding test code that exercises the deleted functions.

Purpose: Eliminate dead code so the codebase reflects only live, callable functionality.
Output: Smaller, cleaner source files with no dead code paths; all tests still pass.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/38-codebase-cleanup/38-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete dead modules, remove dead CLI choices, remove dead functions</name>
  <files>
    variantcentrifuge/stage_info.py
    variantcentrifuge/cli.py
    variantcentrifuge/inheritance/prioritizer.py
    variantcentrifuge/inheritance/analyzer.py
    variantcentrifuge/stages/analysis_stages.py
  </files>
  <action>
DEAD-01: Delete `variantcentrifuge/stage_info.py` entirely. Grep for any import of `stage_info` to confirm zero references.

DEAD-02: In `variantcentrifuge/cli.py` lines 437-442, change coast-backend choices from `["auto", "r", "python"]` to `["auto", "python"]`. In `variantcentrifuge/stages/analysis_stages.py` line 2199, remove `"r"` from the validation check for coast_backend.

DEAD-03: In `variantcentrifuge/inheritance/prioritizer.py`, remove these 6 functions (keep `prioritize_patterns`, `calculate_confidence`, `get_pattern_description`):
- `adjust_pattern_score` (lines ~133-155)
- `get_pattern_category` (lines ~198-212)
- `group_patterns_by_category` (lines ~215-236)
- `resolve_conflicting_patterns` (lines ~290-331)
- `filter_compatible_patterns` (lines ~334-357)
- `is_pattern_compatible` (lines ~360-389)

DEAD-04: In `variantcentrifuge/inheritance/analyzer.py`:
- Remove `get_inheritance_summary` (lines ~407-454)
- Remove `filter_by_inheritance_pattern` (lines ~457-487)
- Remove `export_inheritance_report` (lines ~490-530)
- Rename `create_inheritance_details` to `_create_inheritance_details` and update the call site in `_finalize_inheritance_patterns` to use the new private name

DEAD-05: In `variantcentrifuge/cli.py` lines 938-951, remove the `--gzip-intermediates` store_true argument. Keep the `--no-gzip-intermediates` argument. Ensure the default remains True (check `set_defaults` or add `default=True` to the remaining argument).

CLEAN-05: In `variantcentrifuge/stages/analysis_stages.py` line 760, remove lines 760-763 (the dead `chunks` config key TODO(12-02) check).
  </action>
  <verify>
Run: `grep -r "stage_info" variantcentrifuge/ tests/` — should return nothing.
Run: `grep -r "coast.backend.*r" variantcentrifuge/cli.py` — should not match `"r"` as a choice.
Run: `grep -rn "adjust_pattern_score\|get_pattern_category\|group_patterns_by_category\|resolve_conflicting_patterns\|filter_compatible_patterns\|is_pattern_compatible" variantcentrifuge/` — should return nothing.
Run: `grep -rn "get_inheritance_summary\|filter_by_inheritance_pattern\|export_inheritance_report" variantcentrifuge/` — should return nothing.
Run: `grep -rn "create_inheritance_details" variantcentrifuge/inheritance/analyzer.py` — should show only `_create_inheritance_details`.
  </verify>
  <done>stage_info.py deleted; --coast-backend r removed; 11 dead functions removed from prioritizer.py and analyzer.py; create_inheritance_details made private; --gzip-intermediates store_true removed; TODO(12-02) dead check removed.</done>
</task>

<task type="auto">
  <name>Task 2: Remove dead tests and fix test imports</name>
  <files>
    tests/unit/test_backend_defaults.py
    tests/test_inheritance/test_prioritizer.py
    tests/test_inheritance/test_enhanced_prioritizer.py
    tests/test_inheritance/test_analyzer.py
    tests/test_inheritance/test_inheritance_integration.py
    tests/test_inheritance/test_performance_optimizations.py
    tests/integration/test_pipeline_with_mocked_tools.py
  </files>
  <action>
DEAD-02 tests: In `tests/unit/test_backend_defaults.py`, delete `test_config_coast_backend_can_be_set_to_r` (lines ~74-77).

DEAD-03 tests: In `tests/test_inheritance/test_prioritizer.py`, remove all test functions for deleted functions:
- All `test_adjust_pattern_score_*` tests
- `test_get_pattern_category`
- `test_group_patterns_by_category`
- `test_resolve_conflicting_patterns`
- `test_filter_compatible_patterns`
- `test_is_pattern_compatible`
- Remove corresponding imports of deleted functions
- Keep `test_get_pattern_description` and tests for `prioritize_patterns`, `calculate_confidence`

In `tests/test_inheritance/test_enhanced_prioritizer.py`, remove:
- `TestScoreAdjustment` class (lines ~68-107)
- `TestPatternCategories` class (lines ~136-165)
- `TestConflictResolution` class (lines ~179-217)
- `TestPatternFiltering` class (lines ~219-237)
- Remove imports of deleted functions

DEAD-04 tests: In `tests/test_inheritance/test_analyzer.py`, remove tests for `get_inheritance_summary`, `filter_by_inheritance_pattern`, `export_inheritance_report`, and their imports. Update any import of `create_inheritance_details` to `_create_inheritance_details` if tested directly (but prefer removing those tests since it's now private).

In `tests/test_inheritance/test_inheritance_integration.py`, remove tests referencing deleted functions and their imports.

In `tests/test_inheritance/test_performance_optimizations.py`, update any import of `create_inheritance_details` to `_create_inheritance_details`.

CLEAN-04: In `tests/integration/test_pipeline_with_mocked_tools.py`:
- Remove `test_parallel_variant_extraction` method (line ~357, xfail'd, tests removed stage)
- Evaluate `TestBCFToolsPrefilter` class (lines ~500+) — if it tests live functionality, keep it; if it tests removed parallel extraction, remove it
  </action>
  <verify>
Run: `make ci-check` — all lint checks pass, all tests pass.
Run: `pytest tests/test_inheritance/ -x -q` — inheritance tests pass.
Run: `pytest tests/integration/ -x -q` — integration tests pass.
  </verify>
  <done>All test code for deleted functions is removed. No imports of deleted functions remain in test files. `make ci-check` passes with zero errors.</done>
</task>

</tasks>

<verification>
1. `make ci-check` passes (lint + format + typecheck + tests)
2. `grep -r "stage_info" variantcentrifuge/ tests/` returns nothing
3. `python -c "from variantcentrifuge.cli import main; main(['--help'])"` shows coast-backend choices as auto/python only
4. No references to deleted functions in any source or test file
</verification>

<success_criteria>
- stage_info.py is deleted with zero remaining references
- --coast-backend choices are ["auto", "python"] only
- 11 dead functions removed from prioritizer.py and analyzer.py
- --gzip-intermediates store_true variant removed
- Dead integration test methods removed
- All 2200+ tests pass
- `make ci-check` passes clean
</success_criteria>

<output>
After completion, create `.planning/phases/38-codebase-cleanup/38-01-SUMMARY.md`
</output>
