---
phase: 38-codebase-cleanup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/source/faq.md
  - docs/source/guides/association_testing.md
  - docs/source/changelog.md
  - tests/integration/test_basic_pipeline.py
  - tests/integration/test_pipeline_with_mocked_tools.py
  - tests/integration/test_inheritance_analysis_integration.py
  - variantcentrifuge/pipeline.py
  - variantcentrifuge/stages/processing_stages.py
  - variantcentrifuge/stages/setup_stages.py
autonomous: true

must_haves:
  truths:
    - "faq.md contains no references to removed CLI flags (--bcftools-filter, --chunks, --gzip-intermediates, --interval-expansion, --no-filtering)"
    - "association_testing.md uses skat_o_pvalue not skat_pvalue"
    - "changelog.md does not reference 'classic pipeline' mode"
    - "No source file or test contains 'original pipeline' or 'refactored pipeline' as stale terminology"
    - "association_testing.md documents that Fisher lambda_GC is diagnostic-only"
  artifacts:
    - path: "docs/source/faq.md"
      provides: "Accurate CLI flag documentation"
    - path: "docs/source/guides/association_testing.md"
      provides: "Correct column names and lambda_GC clarification"
      contains: "skat_o_pvalue"
    - path: "docs/source/changelog.md"
      provides: "No classic pipeline references"
  key_links: []
---

<objective>
Fix all stale documentation and comments: correct removed CLI flags in faq.md, fix column name in association_testing.md, update changelog.md, update stale docstrings/comments in integration tests and source files, and add Fisher lambda_GC clarification.

Purpose: Ensure all documentation and code comments reflect the current state of the codebase.
Output: Accurate docs and comments with no references to removed features or outdated terminology.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/38-codebase-cleanup/38-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix documentation files</name>
  <files>
    docs/source/faq.md
    docs/source/guides/association_testing.md
    docs/source/changelog.md
  </files>
  <action>
DOCS-01: In `docs/source/faq.md`, fix/remove references to removed CLI flags at lines 146, 151, 156, 161, 168, 179, 184:
- `--bcftools-filter` — removed in v0.13.0, replace with current equivalent or remove the FAQ entry
- `--chunks` — removed, update or remove
- `--gzip-intermediates` — being simplified, update to reflect `--no-gzip-intermediates` only
- `--interval-expansion` — removed, update or remove
- `--no-filtering` — removed, update or remove
Read the file first to understand context around each reference, then update or remove entries as appropriate. If a flag was replaced by something else, update the reference. If the feature no longer exists, remove the FAQ entry.

DOCS-02: In `docs/source/guides/association_testing.md`:
- Line 334: Change `skat_pvalue` to `skat_o_pvalue`
- Line 439: Change `skat_pvalue` to `skat_o_pvalue`
Search the entire file for any other occurrences of `skat_pvalue` (without the `_o_`) and fix them too.

DOCS-03: In `docs/source/changelog.md` line 51:
- Change "Resource auto-detection across classic and stage-based pipeline modes" to "Resource auto-detection across pipeline modes"

CLEAN-07: In `docs/source/guides/association_testing.md`, find the lambda_GC section (around line 531). Add a note clarifying that lambda_GC computed for Fisher's exact test is diagnostic-only and is not used for p-value correction. Keep the note brief (1-2 sentences).
  </action>
  <verify>
Run: `grep -n "bcftools-filter\|--chunks\|--gzip-intermediates\|--interval-expansion\|--no-filtering" docs/source/faq.md` — should return nothing (or only valid current flags).
Run: `grep -n "skat_pvalue" docs/source/guides/association_testing.md | grep -v "skat_o_pvalue"` — should return nothing.
Run: `grep -n "classic.*pipeline\|classic and stage" docs/source/changelog.md` — should return nothing.
  </verify>
  <done>faq.md has no references to removed CLI flags; association_testing.md uses skat_o_pvalue everywhere; changelog.md has no classic pipeline reference; lambda_GC diagnostic note added.</done>
</task>

<task type="auto">
  <name>Task 2: Update stale docstrings and comments in source and test files</name>
  <files>
    tests/integration/test_basic_pipeline.py
    tests/integration/test_pipeline_with_mocked_tools.py
    tests/integration/test_inheritance_analysis_integration.py
    variantcentrifuge/pipeline.py
    variantcentrifuge/stages/processing_stages.py
    variantcentrifuge/stages/setup_stages.py
  </files>
  <action>
CLEAN-01: Update stale "refactored pipeline" docstrings in integration tests:
- `tests/integration/test_basic_pipeline.py` line 1: Update module docstring — remove "refactored" qualifier, just say "pipeline" or "stage-based pipeline"
- `tests/integration/test_pipeline_with_mocked_tools.py` lines 1-3: Same treatment — remove "refactored" qualifier from module docstring
- `tests/integration/test_inheritance_analysis_integration.py` line 19: Update docstring/comment — remove "refactored" qualifier

CLEAN-02: Update stale "original pipeline" comments in source files:
- `variantcentrifuge/pipeline.py` line 423: Remove or update comment referencing "original pipeline"
- `variantcentrifuge/stages/processing_stages.py` line 1485: Remove or update comment referencing "original pipeline"
- `variantcentrifuge/stages/setup_stages.py` line 130: Remove or update comment referencing "original pipeline"

In all cases, the codebase has only ONE pipeline now (the stage-based pipeline). References to "original" or "refactored" or "classic" are outdated. Simply remove the qualifier or reword to just "pipeline".
  </action>
  <verify>
Run: `grep -rn "refactored pipeline\|original pipeline\|classic pipeline" variantcentrifuge/ tests/` — should return nothing (or only historical changelog entries).
  </verify>
  <done>No source file or test file contains stale "refactored pipeline", "original pipeline", or "classic pipeline" terminology. All comments and docstrings reflect the current single pipeline architecture.</done>
</task>

</tasks>

<verification>
1. `grep -rn "skat_pvalue" docs/ | grep -v "skat_o_pvalue"` returns nothing
2. `grep -rn "refactored pipeline\|original pipeline" variantcentrifuge/ tests/` returns nothing
3. `make ci-check` passes (confirms no syntax/format issues introduced)
</verification>

<success_criteria>
- faq.md references only current CLI flags
- association_testing.md uses skat_o_pvalue throughout
- changelog.md has no classic pipeline reference
- Fisher lambda_GC documented as diagnostic-only
- All stale docstrings/comments updated
- `make ci-check` passes clean
</success_criteria>

<output>
After completion, create `.planning/phases/38-codebase-cleanup/38-02-SUMMARY.md`
</output>
