---
phase: 29-classic-pipeline-deprecation-and-removal
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - tests/conftest.py
  - tests/test_gene_burden_comprehensive.py
  - tests/test_cli.py
  - tests/fixtures/geneburden/README.md
autonomous: true

must_haves:
  truths:
    - "No test file passes --use-new-pipeline as a CLI argument"
    - "No test docstring mentions --use-new-pipeline as if it exists"
    - "No fixture README references --use-new-pipeline"
    - "All tests pass after flag removal (flag was never parsed)"
  artifacts:
    - path: "tests/conftest.py"
      provides: "Gene burden command template without vestigial flag"
    - path: "tests/test_gene_burden_comprehensive.py"
      provides: "Gene burden tests without vestigial flag"
    - path: "tests/test_cli.py"
      provides: "CLI tests with accurate docstrings"
  key_links:
    - from: "tests/conftest.py"
      to: "tests/test_gene_burden_comprehensive.py"
      via: "gene_burden_cmd_template fixture"
      pattern: "gene_burden_cmd_template"
---

<objective>
Remove all --use-new-pipeline references from test files and test fixture documentation. The flag was never defined in argparse — it's a documentation phantom that was included in test command strings but had no effect.

Purpose: Eliminate confusion about a flag that doesn't exist. Test commands should only include flags that are actually parsed.
Output: Clean test files with no vestigial --use-new-pipeline references.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-classic-pipeline-deprecation-and-removal/29-RESEARCH.md
@tests/conftest.py
@tests/test_gene_burden_comprehensive.py
@tests/test_cli.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove --use-new-pipeline from test command strings</name>
  <files>
    tests/conftest.py
    tests/test_gene_burden_comprehensive.py
  </files>
  <action>
    In tests/conftest.py:
    1. Line 176: Remove the `"--use-new-pipeline",` line from the gene_burden_cmd_template fixture's command list. This is a list of CLI argument strings — just delete that one element.

    In tests/test_gene_burden_comprehensive.py:
    2. Lines 82, 120, 164, 202, 242, 277, 325, 360: Remove each `"--use-new-pipeline",` line from the 8 test command lists. Each occurrence is a standalone line in a list of CLI arguments.

    These are simple string deletions from Python lists. The flag was never parsed by argparse, so removing it changes nothing about test behavior.
  </action>
  <verify>
    Run: `grep -rn "use.new.pipeline\|use_new_pipeline" tests/conftest.py tests/test_gene_burden_comprehensive.py` — should return nothing.
    Run: `pytest tests/test_gene_burden_comprehensive.py -x -q --timeout=30 2>&1 | tail -5` — tests still pass (or skip due to missing tools, which is expected).
  </verify>
  <done>All --use-new-pipeline strings removed from conftest.py and test_gene_burden_comprehensive.py; tests behave identically.</done>
</task>

<task type="auto">
  <name>Task 2: Update test_cli.py docstrings and fixture README</name>
  <files>
    tests/test_cli.py
    tests/fixtures/geneburden/README.md
  </files>
  <action>
    In tests/test_cli.py:
    1. Line 60: Update the docstring `"""Test --show-checkpoint-status with --use-new-pipeline flag."""` to remove the --use-new-pipeline mention. Change to something like `"""Test --show-checkpoint-status flag."""` or `"""Test --show-checkpoint-status with stage-based pipeline."""`
    2. Line 176: Update the docstring `"""Test that --use-new-pipeline flag takes precedence over config file."""` to `"""Test that stage-based pipeline is used regardless of config file settings."""` — only the docstring references --use-new-pipeline; the test body does NOT pass the flag to sys.argv, so the test body must not be removed or altered.

    In tests/fixtures/geneburden/README.md:
    3. Lines 73, 87, 99, 114, 129: Remove `--use-new-pipeline` from all 5 example command lines. These are documentation examples showing how to generate test fixtures.

    Run `grep -rn "use.new.pipeline\|use_new_pipeline" tests/` to confirm no remaining references.
  </action>
  <verify>
    Run: `grep -rn "use.new.pipeline\|use_new_pipeline" tests/` — should return nothing.
    Run: `make test-fast` — all tests pass.
    Run: `make lint` — no lint errors.
  </verify>
  <done>Zero references to --use-new-pipeline remain in tests/ directory; all test docstrings accurately describe what they test.</done>
</task>

</tasks>

<verification>
1. `grep -rn "use.new.pipeline\|use_new_pipeline" tests/` returns nothing
2. `grep -rn "use.new.pipeline\|use_new_pipeline" tests/fixtures/` returns nothing
3. `make test-fast` passes
4. `make lint` passes
</verification>

<success_criteria>
- Zero occurrences of --use-new-pipeline in any test file or fixture
- Test docstrings accurately describe what each test verifies
- All tests pass unchanged (flag was never parsed)
</success_criteria>

<output>
After completion, create `.planning/phases/29-classic-pipeline-deprecation-and-removal/29-02-SUMMARY.md`
</output>
