---
phase: 29-classic-pipeline-deprecation-and-removal
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - CLAUDE.md
  - README.md
autonomous: true

must_haves:
  truths:
    - "CLAUDE.md describes a single pipeline architecture (no 'Two Pipeline Modes')"
    - "README.md does not reference --use-new-pipeline"
    - "Documentation accurately reflects that pipeline.py IS the stage-based pipeline"
  artifacts:
    - path: "CLAUDE.md"
      provides: "Project instructions with single pipeline architecture description"
    - path: "README.md"
      provides: "Project README without legacy pipeline references"
  key_links:
    - from: "CLAUDE.md"
      to: "variantcentrifuge/pipeline.py"
      via: "architecture description"
      pattern: "pipeline\\.py.*stage"
---

<objective>
Update CLAUDE.md and README.md to describe a single stage-based pipeline architecture, removing all references to "two pipeline modes", the classic pipeline, and the --use-new-pipeline flag.

Purpose: Documentation should reflect reality — there is one pipeline, it's stage-based, and there's no flag to select between modes.
Output: Accurate CLAUDE.md and README.md reflecting single pipeline architecture.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-classic-pipeline-deprecation-and-removal/29-RESEARCH.md
@CLAUDE.md
@README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update CLAUDE.md architecture section</name>
  <files>CLAUDE.md</files>
  <action>
    In CLAUDE.md, replace the "Two Pipeline Modes" subsection (lines ~34-39) which currently reads:

    ```
    ### Two Pipeline Modes
    The tool has two pipeline architectures selectable at runtime:
    1. **Classic Pipeline** (default) — `pipeline.py` calls into processing modules directly
    2. **Stage-Based Pipeline** (`--use-new-pipeline`) — `pipeline_core/` framework with 40+ modular stages

    Both are invoked through a single entry point: `variantcentrifuge.cli:main`.
    ```

    Replace with a single pipeline description:

    ```
    ### Pipeline Architecture
    The tool uses a stage-based pipeline architecture invoked through `variantcentrifuge.cli:main`:
    - **`pipeline.py`** — Builds and runs the stage-based pipeline using `PipelineRunner`, `PipelineContext`, and registered stages from `pipeline_core/`
    - **`pipeline_core/`** — Framework with 40+ modular stages, dependency graph analysis, parallel execution
    ```

    This removes the false impression that two pipelines exist and accurately describes the actual architecture.

    Also scan the rest of CLAUDE.md for any other mentions of "classic pipeline", "--use-new-pipeline", or "new pipeline" and remove/update them.
  </action>
  <verify>
    Run: `grep -in "classic pipeline\|use.new.pipeline\|two pipeline\|new pipeline" CLAUDE.md` — should return nothing.
    Visually confirm the Architecture section reads coherently.
  </verify>
  <done>CLAUDE.md describes a single stage-based pipeline architecture; no references to classic pipeline or --use-new-pipeline remain.</done>
</task>

<task type="auto">
  <name>Task 2: Update README.md</name>
  <files>README.md</files>
  <action>
    In README.md:
    1. Line 26: Remove `(--use-new-pipeline)` from the line about stage-based pipeline architecture. The line currently reads something like:
       `- Stage-based pipeline architecture with parallel execution (--use-new-pipeline)`
       Change to:
       `- Stage-based pipeline architecture with parallel execution`

    2. Scan the entire README.md for any other mentions of "--use-new-pipeline", "classic pipeline", or "two pipeline" and update/remove them.

    Do NOT rewrite sections that don't mention the legacy pipeline. Minimal changes only.
  </action>
  <verify>
    Run: `grep -in "classic pipeline\|use.new.pipeline\|two pipeline" README.md` — should return nothing.
    Run: `make lint` — passes (catches any markdown issues if linted).
  </verify>
  <done>README.md has no references to --use-new-pipeline or classic pipeline; stage-based pipeline described as the architecture (not an option).</done>
</task>

</tasks>

<verification>
1. `grep -rn "use.new.pipeline\|classic pipeline\|two pipeline" CLAUDE.md README.md` returns nothing
2. CLAUDE.md Architecture section coherently describes single pipeline
3. README.md feature list references stage-based pipeline without flag
4. `make ci-check` passes (if docs are linted)
</verification>

<success_criteria>
- CLAUDE.md "Two Pipeline Modes" section replaced with "Pipeline Architecture" describing single stage-based pipeline
- README.md --use-new-pipeline reference removed
- No documentation anywhere suggests multiple pipeline modes exist
</success_criteria>

<output>
After completion, create `.planning/phases/29-classic-pipeline-deprecation-and-removal/29-03-SUMMARY.md`
</output>
