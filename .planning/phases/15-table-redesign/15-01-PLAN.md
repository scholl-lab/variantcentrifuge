---
phase: 15-table-redesign
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - variantcentrifuge/assets/js/fixedcolumns.min.js
  - variantcentrifuge/assets/css/fixedcolumns.dataTables.min.css
  - variantcentrifuge/templates/index.html
autonomous: true

must_haves:
  truths:
    - "FixedColumns JS and CSS assets exist in vendored assets directory"
    - "Table header row has dark background with white text and colored bottom border"
    - "Table rows have alternating zebra stripe backgrounds"
    - "Density CSS classes exist for compact, regular, and relaxed modes"
    - "Detail panel CSS with grid layout and card sections is defined"
    - "Monospace and truncation CSS classes are defined"
    - "Record count info element is styled prominently"
  artifacts:
    - path: "variantcentrifuge/assets/js/fixedcolumns.min.js"
      provides: "DataTables FixedColumns extension JS"
    - path: "variantcentrifuge/assets/css/fixedcolumns.dataTables.min.css"
      provides: "DataTables FixedColumns extension CSS"
    - path: "variantcentrifuge/templates/index.html"
      provides: "Updated CSS styles for table redesign"
      contains: "density-compact"
  key_links:
    - from: "variantcentrifuge/templates/index.html"
      to: "variantcentrifuge/assets/css/fixedcolumns.dataTables.min.css"
      via: "Jinja2 asset embedding"
      pattern: "assets\\['css/fixedcolumns"
---

<objective>
Vendor the DataTables FixedColumns extension and add all CSS styles needed for Phase 15 table redesign (dark header, zebra striping, density modes, detail panel, column classes, record count).

Purpose: Establish the visual foundation and vendored assets so Plan 02 can wire up JS behavior.
Output: FixedColumns JS+CSS vendored, template CSS updated with all new styles.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-table-redesign/15-RESEARCH.md
@.planning/phases/15-table-redesign/15-CONTEXT.md
@variantcentrifuge/templates/index.html
@variantcentrifuge/generate_html_report.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Vendor FixedColumns extension assets</name>
  <files>
    variantcentrifuge/assets/js/fixedcolumns.min.js
    variantcentrifuge/assets/css/fixedcolumns.dataTables.min.css
  </files>
  <action>
Download DataTables FixedColumns v5.0.5 JS and CSS from jsDelivr CDN:

```bash
curl -o variantcentrifuge/assets/js/fixedcolumns.min.js \
  https://cdn.jsdelivr.net/npm/datatables.net-fixedcolumns@5.0.5/js/dataTables.fixedColumns.min.js

curl -o variantcentrifuge/assets/css/fixedcolumns.dataTables.min.css \
  https://cdn.jsdelivr.net/npm/datatables.net-fixedcolumns-dt@5.0.5/css/fixedColumns.dataTables.min.css
```

If jsDelivr is unavailable, try unpkg as fallback:
- `https://unpkg.com/datatables.net-fixedcolumns@5.0.5/js/dataTables.fixedColumns.min.js`
- `https://unpkg.com/datatables.net-fixedcolumns-dt@5.0.5/css/fixedColumns.dataTables.min.css`

Verify both files are non-empty and contain valid JS/CSS (not HTML error pages). The JS file should contain "fixedColumns" and the CSS should contain "dtfc".

No changes to `generate_html_report.py` needed -- the `_load_assets()` function auto-discovers all files in `assets/js/` and `assets/css/` directories.
  </action>
  <verify>
    - `ls -la variantcentrifuge/assets/js/fixedcolumns.min.js` shows non-zero size
    - `ls -la variantcentrifuge/assets/css/fixedcolumns.dataTables.min.css` shows non-zero size
    - `grep -c "fixedColumns\|FixedColumns" variantcentrifuge/assets/js/fixedcolumns.min.js` returns > 0
    - `grep -c "dtfc" variantcentrifuge/assets/css/fixedcolumns.dataTables.min.css` returns > 0
  </verify>
  <done>FixedColumns v5.0.5 JS and CSS are vendored in assets directory and will be auto-loaded by _load_assets()</done>
</task>

<task type="auto">
  <name>Task 2: Add CSS styles and asset references to template</name>
  <files>variantcentrifuge/templates/index.html</files>
  <action>
Modify `variantcentrifuge/templates/index.html` with the following CSS and HTML changes. Do NOT modify any JavaScript in this task (that is Plan 02).

**1. Add FixedColumns CSS inline in `<head>` (after existing CSS asset inlines, before custom `<style>` block):**

```html
<style>{{ assets['css/fixedcolumns.dataTables.min'] }}</style>
```

**2. Add FixedColumns JS inline in `<script>` section (after datatables.min.js, before buttons scripts):**

```html
<script>{{ assets['js/fixedcolumns.min'] }}</script>
```

**3. Replace existing table header styles (lines ~147-160) with enhanced dark header:**

Replace the current `#variants_table th` styles with:

```css
/* TABLE-05: Dark header with white text and accent bottom border */
#variants_table thead th,
.dt-scroll-head thead th,
.dataTables_scrollHead thead th {
    background: linear-gradient(180deg, #2c3e50 0%, #1a252f 100%);
    color: white;
    border-bottom: 3px solid #007bff;
    white-space: nowrap !important;
    text-align: left !important;
    vertical-align: middle;
    line-height: 1.3;
    padding: 10px 22px 10px 8px !important;
    font-weight: 600;
}
```

Keep the existing `dt-type-numeric` left-align override and `dt-scroll-body thead` hide rule.

**4. Replace existing `#variants_table td` styles with zebra + density-aware defaults:**

```css
/* TABLE-04: Zebra striping */
#variants_table tbody tr:nth-child(odd) {
    background-color: #f8f9fa;
}
#variants_table tbody tr:nth-child(even) {
    background-color: white;
}
#variants_table tbody tr:hover {
    background-color: #e3f2fd;
}
/* Child row should not get zebra color */
#variants_table tbody tr.dt-hasChild + tr > td {
    background-color: transparent !important;
}

#variants_table td {
    text-align: left;
    vertical-align: top;
    line-height: 1.3;
    padding: 4px 6px;
}
```

**5. Add density mode CSS (after td styles):**

```css
/* TABLE-07: Content density modes */
#variants_table.density-compact td { padding: 4px 6px; line-height: 1.3; }
#variants_table.density-compact th { padding: 8px 22px 8px 6px !important; }
#variants_table.density-regular td { padding: 8px 10px; line-height: 1.5; }
#variants_table.density-regular th { padding: 10px 22px 10px 10px !important; }
#variants_table.density-relaxed td { padding: 12px 14px; line-height: 1.7; }
#variants_table.density-relaxed th { padding: 12px 22px 12px 14px !important; }
```

**6. Add column type CSS classes (after density styles):**

```css
/* TABLE-06/08: Column type classes */
.monospace {
    font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
}
.dt-right {
    text-align: right !important;
}
.middle-truncate {
    display: inline-block;
    max-width: 120px;
}

/* TABLE-02: FixedColumns shadow separator */
.dtfc-fixed-left {
    box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
    z-index: 2;
}
```

**7. Add expandable row detail panel CSS (after column classes):**

```css
/* TABLE-03: Chevron control column */
td.dt-control {
    cursor: pointer;
    text-align: center !important;
    width: 30px;
    user-select: none;
}
td.dt-control .chevron {
    display: inline-block;
    font-size: 18px;
    font-weight: bold;
    color: #007bff;
    transition: transform 200ms ease-in-out;
}
tr.shown td.dt-control .chevron {
    transform: rotate(90deg);
}

/* TABLE-03: Detail panel grid layout */
.detail-panel {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 16px;
    padding: 16px;
    background-color: #f8f9fa;
    border-left: 3px solid #007bff;
    animation: slideDown 200ms ease-out;
}
@keyframes slideDown {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}
.detail-section {
    background: white;
    padding: 12px 14px;
    border-radius: 6px;
    border: 1px solid #dee2e6;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}
.detail-section h4 {
    margin: 0 0 10px 0;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #6c757d;
    font-weight: 700;
}
.detail-section dl {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 6px 12px;
    margin: 0;
    font-size: 13px;
}
.detail-section dt {
    font-weight: 600;
    color: #495057;
}
.detail-section dd {
    margin: 0;
    word-break: break-word;
    color: #212529;
}
.detail-section a {
    color: #007bff;
    text-decoration: none;
}
.detail-section a:hover {
    text-decoration: underline;
}
```

**8. Update record count info styling (after detail panel CSS):**

```css
/* TABLE-09: Prominent record count */
.dt-info,
.dataTables_info {
    font-size: 14px;
    font-weight: 600;
    color: #212529;
    padding: 8px 0;
}
```

**9. Update Tippy tooltip config per TABLE-01 (in CSS):**

Update the existing `.tippy-box[data-theme~='variantcentrifuge']` rule to set `max-width: 300px` instead of `400px`:

```css
.tippy-box[data-theme~='variantcentrifuge'] {
    background-color: #333;
    color: #fff;
    max-width: 300px;
    font-size: 13px;
    line-height: 1.5;
    word-break: break-word;
}
```

Also update the existing `.truncated-cell` to `max-width: 180px` instead of `150px` (better for HGVS notation).

**Important:** Keep all existing CSS that is NOT being replaced (link styles, skeleton, alert, badge, dashboard, metadata footer, chart styles). Only replace/add the specific styles listed above.
  </action>
  <verify>
    - Template contains `assets['css/fixedcolumns.dataTables.min']` inline reference
    - Template contains `assets['js/fixedcolumns.min']` inline reference
    - `grep -c "density-compact" variantcentrifuge/templates/index.html` returns > 0
    - `grep -c "detail-panel" variantcentrifuge/templates/index.html` returns > 0
    - `grep -c "dt-control" variantcentrifuge/templates/index.html` returns > 0
    - `grep -c "dtfc-fixed-left" variantcentrifuge/templates/index.html` returns > 0
    - `grep -c "#2c3e50" variantcentrifuge/templates/index.html` returns > 0 (dark header)
    - `grep -c "nth-child(odd)" variantcentrifuge/templates/index.html` returns > 0 (zebra)
    - `make lint` passes (Python files only, template is HTML)
  </verify>
  <done>Template has all CSS styles for Phase 15: dark header, zebra striping, density modes, detail panel, column classes, FixedColumns shadow, record count, updated tooltips. FixedColumns assets are inlined.</done>
</task>

</tasks>

<verification>
- FixedColumns JS and CSS files exist and contain valid content
- Template renders without Jinja2 errors (asset keys resolve)
- All new CSS classes are present in the template's style block
- Existing CSS (badge, dashboard, skeleton, metadata) is preserved
- `make lint` passes
</verification>

<success_criteria>
1. FixedColumns v5.0.5 JS+CSS vendored in assets directory
2. Template contains inline references for both FixedColumns assets
3. Dark header gradient, zebra striping, density mode classes all in CSS
4. Detail panel grid layout and chevron animation CSS defined
5. Monospace, right-align, middle-truncate, and truncated-cell CSS classes defined
6. Record count info styled prominently
7. Tooltip max-width updated to 300px per TABLE-01
</success_criteria>

<output>
After completion, create `.planning/phases/15-table-redesign/15-01-SUMMARY.md`
</output>
