---
phase: 34-tech-debt
plan: "02"
subsystem: association
tags: [association, column-naming, pvalue, qvalue, skat-o, coast, diagnostics, docs]

# Dependency graph
requires:
  - phase: 33-gene-level-fdr-weighting
    provides: acat_o_qvalue column (was acat_o_corrected_p_value)
provides:
  - All association DataFrame columns use _pvalue suffix (no underscore-separated "value")
  - acat_o_qvalue replaces acat_o_corrected_p_value
  - skat_o_pvalue column when skat_method=SKATO (renamed from skat_pvalue post-loop)
  - coast_burden_pvalue and coast_skat_pvalue in COAST extra dict
  - All 2001 tests pass with new naming convention
affects:
  - 35-diagnostics-wiring (any diagnostics reading p-value columns use new names)
  - any downstream consumer parsing association TSV output

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Clean break column naming: _pvalue suffix for raw, _qvalue suffix for corrected"
    - "SKAT-O post-processing in engine row builder renames skat_pvalue->skat_o_pvalue"

key-files:
  created: []
  modified:
    - variantcentrifuge/association/engine.py
    - variantcentrifuge/association/diagnostics.py
    - variantcentrifuge/association/tests/allelic_series_python.py
    - variantcentrifuge/association/tests/allelic_series.py
    - variantcentrifuge/stages/analysis_stages.py
    - tests/unit/test_association_engine.py
    - tests/unit/test_association_diagnostics.py
    - tests/unit/test_association_fisher.py
    - tests/unit/test_association_stage.py
    - tests/unit/test_engine_skat_integration.py
    - tests/unit/test_coast.py
    - tests/unit/test_coast_python.py
    - tests/unit/test_qq_plot.py
    - tests/unit/test_parallel_association.py
    - docs/source/guides/association_testing.md
    - docs/source/faq.md

decisions:
  - "Clean break with no backward compatibility aliases (per CONTEXT.md decision)"
  - "skat_o_pvalue is generated by post-processing in engine.py row builder, not in skat_python.py"
  - "Internal backend dict keys (burden_p_values, skat_p_value in coast_python.py) are NOT renamed"
  - "Gene burden context columns (raw_p_value, corrected_p_value in gene_burden.py) are NOT renamed"

metrics:
  duration: "~10 minutes"
  completed: "2026-02-24"
---

# Phase 34 Plan 02: Column Name Standardization Summary

**One-liner:** Renamed all association DataFrame column suffixes from `_p_value`/`_corrected_p_value` to `_pvalue`/`_qvalue` with SKAT-O producing `skat_o_pvalue`.

## What Was Done

### Column Naming Convention (Clean Break)

The following renaming was applied across all association DataFrame columns:

| Old Name | New Name |
|----------|----------|
| `{test}_p_value` | `{test}_pvalue` |
| `acat_o_p_value` | `acat_o_pvalue` |
| `acat_o_corrected_p_value` | `acat_o_qvalue` |
| `coast_burden_p_value` | `coast_burden_pvalue` |
| `coast_skat_p_value` | `coast_skat_pvalue` |
| `skat_pvalue` (when SKATO) | `skat_o_pvalue` |

### Source File Changes

**engine.py:**
- Updated module docstring with new column names
- Changed `f"{test_name}_p_value"` to `f"{test_name}_pvalue"` in the row builder loop
- Changed `"acat_o_p_value"` to `"acat_o_pvalue"` and `"acat_o_corrected_p_value"` to `"acat_o_qvalue"`
- Added SKAT-O post-processing: when `res.extra.get("skat_method") == "SKATO"`, renames `skat_pvalue` to `skat_o_pvalue` via pop+assign in the row dict

**diagnostics.py:**
- Updated `acat_o_p_value` detection to `acat_o_pvalue`
- Updated p-value column lookup from `{tid}_p_value` to `{tid}_pvalue`

**allelic_series_python.py (Python COAST backend):**
- Extra dict keys renamed: `coast_burden_p_value` -> `coast_burden_pvalue`, `coast_skat_p_value` -> `coast_skat_pvalue`

**allelic_series.py (R COAST backend):**
- Same extra dict key renames

**analysis_stages.py:**
- Q-value column detection: `endswith("_corrected_p_value")` -> `endswith("_qvalue")`

### Test File Changes

All column name string literals updated across 9 test files. Internal backend dict keys (e.g., `skat_p_value` in coast_python.py backend, `burden_p_values`) were intentionally left unchanged as they are not DataFrame column names.

### Documentation Changes

- `association_testing.md`: All column names in sample output, reference tables, and text
- `faq.md`: `acat_o_corrected_p_value` -> `acat_o_qvalue` in FAQ answer

## Verification

- `make test-fast`: 2001 passed, 3 skipped, 125 deselected
- `make lint`: All checks passed
- No old column name string literals remain in source or test files (excluding internal backend dict keys)

## Deviations from Plan

None - plan executed exactly as written.

## Next Phase Readiness

- Phase 35 (Diagnostics Wiring): Must use `{tid}_pvalue` and `acat_o_pvalue` column names when wiring diagnostics output
